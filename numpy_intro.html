
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="NumPy-Introduction">NumPy Introduction<a class="anchor-link" href="#NumPy-Introduction">&#182;</a></h1>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(Data-analysis-and-data-mining-with-Python,-17-19-Nov,-2014,-J&#252;lich-Supercomputing-Centre)">(Data analysis and data mining with Python, 17-19 Nov, 2014, J&#252;lich Supercomputing Centre)<a class="anchor-link" href="#(Data-analysis-and-data-mining-with-Python,-17-19-Nov,-2014,-J&#252;lich-Supercomputing-Centre)">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p><em>version 0.1 by ozi</em></p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python is an interpreted language and as such it is extremely flexible, allowing to define everything, including code itself, at runtime. This entails that the Python interpreter uses a lot of magic behind the scenes (e.g. type inferencing) to keep things as simple and productive as possible for the programmer. This flexibility comes at the price of a markedly reduced runtime speed compared to compiled languages such as C++. Many problems encoded in Python do not require the full range of flexibility and could easily trade it for improved runtime performance without giving up the development performance which is the key for Python's success.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>NumPy is a library, written in C, to enable fast numerical computing in Python. The main sacrifice to enable this speed is the restriction to containers with uniform memory layout, i.e. arrays that contain items of uniform static datatype. Despite this apparently severe restriction NumPy is quite versatile and giving a full introduction into NumPy would require a course of its own. Hence we will focus on only few key features and an overview of the available functionality and leave in-depth exploration to the user. The numpy website http://numpy.scipy.org is a good starting point.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note:</strong> NumPy is not a part of the vanilla Python distribution and needs to be installed separately. Then it can be used like any other python library:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[2]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[2]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
&apos;1.9.1&apos;
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ndarray">ndarray<a class="anchor-link" href="#ndarray">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>The main datatype in NumPy is an n-dimensional array object called <code>ndarray</code>. By default it has C-array memory layout (last index fastest, 0 based indices) and its item type is <code>float64</code>. If the <code>ndarray</code> is created from user-specified data the default item type will be the 'minimal' datatype that can hold the data unless explicitely specified otherwise.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="creation,-type">creation, type<a class="anchor-link" href="#creation,-type">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[4]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]])</span>  <span class="c"># from python list</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c"># float64 if no dtype given!</span>
<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">+</span><span class="mi">10j</span><span class="p">)</span> <span class="c"># from generator</span>
<span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span> <span class="c"># dto.</span>
<span class="n">e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s">&#39;bool&#39;</span><span class="p">)</span> <span class="c"># explicit specification</span>
<span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="s">&#39;2005-02&#39;</span><span class="p">,</span> <span class="s">&#39;2005-03&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;datetime64[D]&#39;</span><span class="p">)</span> <span class="c"># all the days in a month</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="p">]:</span>
    <span class="k">print</span> <span class="n">i</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
int64
float64
complex128
float64
bool
datetime64[D]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="inspection,-shape">inspection, shape<a class="anchor-link" href="#inspection,-shape">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Several meta data of an <code>ndarray</code> can be obtained. Try also <code>a.ndim,a.size,a.nbytes,a.flags,type(a)</code>. What is the size of a <code>bool</code>?</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[3]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="k">print</span> <span class="n">a</span>  <span class="c"># data</span>
<span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="c"># data type</span>
<span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">itemsize</span> <span class="c"># element size in bytes</span>
<span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="c"># array dimensions</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[[1 2 3]
 [4 5 6]]
int64
8
(2, 3)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="dtypes,-casting">dtypes, casting<a class="anchor-link" href="#dtypes,-casting">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>I you use large arrays, memory may become an issue. NumPy provides data types in various sizes, choose wisely!</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>NumPy dtypes</strong> * (long)float, float16...128 * (long)complex, complex64...256 * (u)int, (u)int8...128 * str, unicode * bool (=1byte!) * datetime64,timedelta64 * object, void</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[1]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">129</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">127</span><span class="p">],[</span><span class="mi">226</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mf">124.9</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s">&#39;int8&#39;</span><span class="p">)</span> <span class="c"># type coercion - no warnings, no exceptions!</span>
<span class="n">a</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_pyerr">
<pre>
<span class="ansired">---------------------------------------------------------------------------</span>
<span class="ansired">NameError</span>                                 Traceback (most recent call last)
<span class="ansigreen">&lt;ipython-input-1-878f2c4f54f4&gt;</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">----&gt; 1</span><span class="ansiyellow"> </span>a<span class="ansiyellow">=</span>np<span class="ansiyellow">.</span>array<span class="ansiyellow">(</span><span class="ansiyellow">[</span><span class="ansiyellow">[</span><span class="ansicyan">129</span><span class="ansiyellow">,</span><span class="ansicyan">128</span><span class="ansiyellow">,</span><span class="ansicyan">127</span><span class="ansiyellow">]</span><span class="ansiyellow">,</span><span class="ansiyellow">[</span><span class="ansicyan">226</span><span class="ansiyellow">,</span><span class="ansicyan">125</span><span class="ansiyellow">,</span><span class="ansicyan">124.9</span><span class="ansiyellow">]</span><span class="ansiyellow">]</span><span class="ansiyellow">,</span>dtype<span class="ansiyellow">=</span><span class="ansiblue">&apos;int8&apos;</span><span class="ansiyellow">)</span> <span class="ansired"># type coercion - no warnings, no exceptions!</span><span class="ansiyellow"></span>
<span class="ansigreen">      2</span> a<span class="ansiyellow"></span>

<span class="ansired">NameError</span>: name &apos;np&apos; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>type-casting</strong> * <code>astype()</code> * <code>asarray()</code></p>
<p><strong>related functions</strong> * <code>tolist()</code> * <code>fromstring()</code></p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[5]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;complex64&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[5]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[-127.+0.j, -128.+0.j,  127.+0.j],
       [ -30.+0.j,  125.+0.j,  124.+0.j]], dtype=complex64)
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[6]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">arr_address</span><span class="o">=</span><span class="nb">hex</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">__array_interface__</span><span class="p">[</span><span class="s">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">arr_address</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[6]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
&apos;0x289bb30&apos;
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>What happens if you cast a datetime64 type into a float? What do the numbers mean? Give it a try:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Almost anything can be cast into an ndarray, whether it makes sense or not:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[7]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;blahh&quot;</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">c</span><span class="o">=</span><span class="p">((((</span><span class="mi">1</span><span class="o">+</span><span class="mi">9j</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="mi">2j</span><span class="p">),(</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">))))</span>
<span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">]):</span>
 <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
 <span class="k">print</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">: data=&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;, dtype=</span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
1: data= [None None 1] , dtype=object
2: data= [&apos;blahh&apos; &apos;12&apos;] , dtype=|S5
3: data= [[   1.+9.j    1.-2.j]
 [  12.+0.j -100.+0.j]] , dtype=complex128
4: data= [&lt;type &apos;type&apos;&gt; &lt;built-in function array&gt; &lt;type &apos;list&apos;&gt;] , dtype=object

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ndarrays:-read-access">ndarrays: read access<a class="anchor-link" href="#ndarrays:-read-access">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Tuple indexing and slicing of an <code>ndarray</code> works in the same way as with normal python lists. The only difference is that tuple indexing of multidimensional ndarrays uses a single square bracket with comma-separated indices. Remember: in Python slices are references!</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[3]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c"># tuple indexing in 1 square bracket</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[3]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
6
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[15]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="p">[:,::</span><span class="mi">3</span><span class="p">]</span> <span class="c"># selects every second column, the rest are skipped</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[15]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[1],
       [4],
       [7]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[16]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[16]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[4, 5, 6],
       [7, 8, 9]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
Drop the first row and the first column of <code>a</code> to get the matrix $(

<p>)</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[29]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[29]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[5, 6],
       [8, 9]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>But an <code>ndarray</code> can be accessed also in more sophisticated ways unavailable for python lists:</p>
<p><strong>fancy indexing</strong></p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[30]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">a</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">]]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[30]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([ 7, 21, 56])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>using a condition </strong></p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[31]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="k">print</span> <span class="n">a</span>
<span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="o">%</span><span class="k">3</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[ 0  7 14 21 28 35 42 49 56 63 70]

</pre>
</div>
</div>

<div class="hbox output_area"><div class="prompt output_prompt">
    Out[31]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([ 0, 21, 42, 63])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>using a boolean mask</strong></p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[36]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="k">print</span> <span class="n">mask</span>
<span class="n">a</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[False  True False  True False False False False  True False]

</pre>
</div>
</div>

<div class="hbox output_area"><div class="prompt output_prompt">
    Out[36]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([ 7, 21, 56])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>using an index array</strong></p>
<p>Index arrays can be created e.g. by the <code>where()</code> function:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[14]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">div_by_three</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="k">3</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">div_by_three</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
(array([0, 3, 6, 9]),)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>...and then be used for fancy indexing:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[15]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="p">[</span><span class="n">div_by_three</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[15]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([ 0, 21, 42, 63])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>A typical use case for this is accessing a second array (of the same dimensions) based on a condition on the first array.</p>
<p>Create an array <code>b</code> that contains the squares of <code>a</code>. Use <code>div_by_three</code> to get the squares divisible by nine.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ndarrays:-write-access">ndarrays: write access<a class="anchor-link" href="#ndarrays:-write-access">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>As slices (including single cells) are references, values can be directly assigned to them. Aternatively the can be filled with <code>fill()</code>.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[39]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="k">print</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span><span class="o">=</span><span class="mi">0</span>
<span class="k">print</span> <span class="n">a</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[5 6]
[[1 2 3]
 [4 0 0]]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[17]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>   <span class="c"># same as a[:]=2.5</span>
<span class="k">print</span> <span class="n">a</span> 
<span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[[2 2 2]
 [2 2 2]]
int64

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Oops! This is NumPy not Python: type coercion, again!</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ndarrays:-shape-shifting">ndarrays: shape shifting<a class="anchor-link" href="#ndarrays:-shape-shifting">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
For efficient handling of multidimensional arrays it is important to distinguish between memory layout and access patterns. The current access pattern is stored in the <code>strides</code> property. NumPy provides a range of methods to manipulate views on <code>ndarrays</code>:
<table>
<tr><td> 
<code>a.transpose()</code> or <code>a.T</code>
</td><td> 
inverts the strides
</td></tr>
<tr><td> 
<code>a.flatten()</code>
</td><td>            
creates a 1d copy
</td></tr>
<tr><td> 
<code>a.flat</code>
</td><td>                 
is a 1d iterator on <code>a</code>
</td></tr>
<tr><td> 
<code>a.ravel()</code>
</td><td>              
creates a view. A view is a reference <em>iff</em> its source is contiguous in memory.
</td></tr>
<tr><td> 
<code>np.newaxis</code>
</td><td>             
a special index to add an empty dimension
</td></tr>
<tr><td> 
<code>a.squeeze()</code>
</td><td>               
removes all empty dimensions
</td></tr>
<tr><td> 
<code>a.reshape</code>
</td><td>             
explicit shape definition, max one dimension can be guessed (enter <code>-1</code>)
</td></tr>
<tr><td> 
<code>a.swapaxes()</code>
</td><td>               
swaps two axis of the <code>ndarray</code>
</td></tr>
</table>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[41]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[41]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
&apos;1.7.1&apos;
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[42]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">a</span><span class="o">.</span><span class="n">strides</span> <span class="c"># amount of bytes of emmory to be skipped to move to the next position</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[42]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
(24, 8)
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[20]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">T</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="k">print</span> <span class="n">b</span> 
<span class="k">print</span> <span class="n">b</span><span class="o">.</span><span class="n">strides</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[[0 4]
 [2 5]
 [3 6]]
(8, 24)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[21]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span> <span class="c"># a view is a reference, strides may be changed</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[21]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[0, 2, 3],
       [4, 5, 6]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[22]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">c</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[22]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([1, 2, 3, 4, 5, 6])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[23]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">flat</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[23]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
21
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[24]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="c"># reference! </span>
<span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[24]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([0, 2, 3])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[25]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">a_t</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">T</span> <span class="c"># a_t is no longer contiguous in memory</span>
<span class="n">d</span><span class="o">=</span><span class="n">a_t</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="c"># copy!</span>
<span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">a_t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[25]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([1, 4])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[26]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c"># 1d-array, shape=(3, )</span>
<span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">b</span>  <span class="c">#3d-array, shape==(3,1,1)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[26]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[[1]],

       [[2]],

       [[3]]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[27]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:]</span>
<span class="n">c</span> <span class="c">#3d-array, shape==(1,1,3)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[27]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[[1, 2, 3]]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[28]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">b</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[28]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([1, 2, 3])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>One dimension of a <code>reshape</code> can be determined automatically. Use -1 to indicate which one:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[29]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">d</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[29]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[[ 0,  1,  2],
        [ 3,  4,  5],
        [ 6,  7,  8]],

       [[ 9, 10, 11],
        [12, 13, 14],
        [15, 16, 17]],

       [[18, 19, 20],
        [21, 22, 23],
        [24, 25, 26]]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[30]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">d</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[30]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[[ 0,  9, 18],
        [ 3, 12, 21],
        [ 6, 15, 24]],

       [[ 1, 10, 19],
        [ 4, 13, 22],
        [ 7, 16, 25]],

       [[ 2, 11, 20],
        [ 5, 14, 23],
        [ 8, 17, 26]]])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convert <code>d</code> into a 2-dimensional array using reshape.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ndarrays:-more-on-creation">ndarrays: more on creation<a class="anchor-link" href="#ndarrays:-more-on-creation">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
NumPy has several convenience functions to create ndarrays with data like:
<table>
<tr><td> 
<code>zeros()</code>
</td><td>     
0-filled array
</td></tr>
<tr><td> 
<code>identity()</code>
</td><td>  
square 0-filled array, main diagonal=1
</td></tr>
<tr><td> 
<code>asarray()</code>
</td><td>   
from list, tuple and their combinations
</td></tr>
<tr><td> 
<code>fromiter()</code>
</td><td>  
from iterator
</td></tr>
<tr><td> 
<code>fromfunction()</code>
</td><td> 
from function evaluated on array positions
</td></tr>
<tr><td> 
<code>diag()</code>
</td><td>      
like identity but diagonal given as vector
</td></tr>
</table>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Often the data to fill ndarrays reside in files. <code>loadtext()</code> provides minimal file parsing for normal and gzip'd text files. Its counterpart is <code>savetxt()</code>.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[44]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">cat</span> <span class="s">&#39;test.dat&#39;</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
////       This and the next line are headers
Name            income          rev_q1  rev_q2  rev_q3  rev_q4
larry,          200,            0,      1.5,    2.8,    0.2
bill,           1000,           12.5,   15,     18,     33.4
steve,          5600,           128,    40,     0,      0

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[32]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;test.dat&#39;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span> <span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[32]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([[  2.00000000e+02,   0.00000000e+00,   1.50000000e+00,
          2.79999995e+00,   2.00000003e-01],
       [  1.00000000e+03,   1.25000000e+01,   1.50000000e+01,
          1.80000000e+01,   3.34000015e+01],
       [  5.60000000e+03,   1.28000000e+02,   4.00000000e+01,
          0.00000000e+00,   0.00000000e+00]], dtype=float32)
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[33]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">dt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s">&#39;name&#39;</span><span class="p">,</span><span class="s">&#39;S10&#39;</span><span class="p">),(</span><span class="s">&#39;income&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">),</span>\
             <span class="p">(</span><span class="s">&#39;revenue&#39;</span><span class="p">,([(</span><span class="s">&#39;q1&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),(</span><span class="s">&#39;q2&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),(</span><span class="s">&#39;q3&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),(</span><span class="s">&#39;q4&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)]))])</span>
<span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;test.dat&#39;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt output_prompt">
    Out[33]:</div>
<div class="box-flex1 output_subarea output_pyout">


<pre>
array([(&apos;larry&apos;, 200, (0.0, 1.5, 2.799999952316284, 0.20000000298023224)),
       (&apos;bill&apos;, 1000, (12.5, 15.0, 18.0, 33.400001525878906)),
       (&apos;steve&apos;, 5600, (128.0, 40.0, 0.0, 0.0))], 
      dtype=[(&apos;name&apos;, &apos;S10&apos;), (&apos;income&apos;, &apos;&lt;i2&apos;), (&apos;revenue&apos;, [(&apos;q1&apos;, &apos;&lt;f4&apos;), (&apos;q2&apos;, &apos;&lt;f4&apos;), (&apos;q3&apos;, &apos;&lt;f4&apos;), (&apos;q4&apos;, &apos;&lt;f4&apos;)])])
</pre>

</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[34]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s">&quot;mydata.txt&quot;</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%5.1f</span><span class="s">&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">)</span>  <span class="c"># reshaping into 5 columns</span>
<span class="o">!</span>cat <span class="s1">&#39;mydata.txt&#39;</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
  0.0,  0.5,  1.0,  1.5,  2.0
  2.5,  3.0,  3.5,  4.0,  4.5
  5.0,  5.5,  6.0,  6.5,  7.0
  7.5,  8.0,  8.5,  9.0,  9.5
 10.0, 10.5, 11.0, 11.5, 12.0
 12.5, 13.0, 13.5, 14.0, 14.5
 15.0, 15.5, 16.0, 16.5, 17.0
 17.5, 18.0, 18.5, 19.0, 19.5
 20.0, 20.5, 21.0, 21.5, 22.0
 22.5, 23.0, 23.5, 24.0, 24.5
 25.0, 25.5, 26.0, 26.5, 27.0
 27.5, 28.0, 28.5, 29.0, 29.5
 30.0, 30.5, 31.0, 31.5, 32.0
 32.5, 33.0, 33.5, 34.0, 34.5
 35.0, 35.5, 36.0, 36.5, 37.0
 37.5, 38.0, 38.5, 39.0, 39.5

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>NumPy also provides file I/O functions for binary formats, including NumPy's own proprietary formats:</p>
<ul>
<li><strong><code>fromfile(), tofile()</code></strong> for binary or text format</li>
<li><strong><code>save(), load()</code></strong> for binary NumPy &quot;npy&quot;-format</li>
<li><strong><code>savez(), load()</code></strong> for binary NumPy &quot;npz&quot;-container format</li>
<li><strong><code>genfromtxt()</code></strong> like <code>loadtxt()</code> but w. more options, checks etc.</li>
</ul>
<p>For &quot;big data&quot;, however, you should have a look on external python libraries to access HDF5 or netCDF files. These libraries will be discussed in more detail later.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Working-with-ndarrays:-ufuncs">Working with ndarrays: ufuncs<a class="anchor-link" href="#Working-with-ndarrays:-ufuncs">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Ufuncs are one of the main reasons why NumPy is much faster than Python. These are vectorized wrappers for scalar functions, i.e. they process arrays elementwise. There are about 80 ufuncs available. http://docs.scipy.org/doc/numpy/reference/ufuncs.html#available-ufuncs</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[45]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&quot;/homeb/zam/meinke/.local/lib/python2.7/site-packages&quot;</span><span class="p">]</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[46]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[47]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="o">%</span><span class="k">timeit</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
10 loops, best of 3: 26.5 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[48]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="nb">pow</span> <span class="k">as</span> <span class="n">pypow</span><span class="p">,</span> <span class="n">sinh</span> <span class="k">as</span> <span class="n">pysinh</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[49]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="o">%</span><span class="k">timeit</span> <span class="p">[</span><span class="n">pysinh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
1 loops, best of 3: 236 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[50]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[51]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="o">%</span><span class="k">timeit</span> <span class="p">[</span><span class="n">pypow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)]</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
1 loops, best of 3: 624 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[52]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="o">%</span><span class="k">timeit</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
10 loops, best of 3: 136 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[53]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_pyerr">
<pre>
<span class="ansired">---------------------------------------------------------------------------</span>
<span class="ansired">ImportError</span>                               Traceback (most recent call last)
<span class="ansigreen">&lt;ipython-input-53-2b79d182c1af&gt;</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">----&gt; 1</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> numba <span class="ansigreen">import</span> jit<span class="ansiyellow"></span>
<span class="ansigreen">      2</span> <span class="ansigreen">from</span> numba <span class="ansigreen">import</span> vectorize<span class="ansiyellow"></span>
<span class="ansigreen">      3</span> <span class="ansigreen">import</span> math<span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/__init__.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      3</span> &quot;&quot;&quot;
<span class="ansigreen">      4</span> <span class="ansigreen">from</span> __future__ <span class="ansigreen">import</span> print_function<span class="ansiyellow">,</span> division<span class="ansiyellow">,</span> absolute_import<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 5</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> <span class="ansiyellow">.</span> <span class="ansigreen">import</span> testing<span class="ansiyellow">,</span> decorators<span class="ansiyellow"></span>
<span class="ansigreen">      6</span> <span class="ansigreen">from</span> <span class="ansiyellow">.</span>_version <span class="ansigreen">import</span> get_versions<span class="ansiyellow"></span>
<span class="ansigreen">      7</span> <span class="ansigreen">from</span> <span class="ansiyellow">.</span> <span class="ansigreen">import</span> special<span class="ansiyellow">,</span> types<span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/decorators.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      5</span> <span class="ansigreen">import</span> warnings<span class="ansiyellow"></span>
<span class="ansigreen">      6</span> <span class="ansigreen">from</span> numba <span class="ansigreen">import</span> sigutils<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 7</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> numba<span class="ansiyellow">.</span>targets <span class="ansigreen">import</span> registry<span class="ansiyellow"></span>
<span class="ansigreen">      8</span> <span class="ansiyellow"></span>
<span class="ansigreen">      9</span> <span class="ansired"># -----------------------------------------------------------------------------</span><span class="ansiyellow"></span><span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/targets/registry.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      1</span> <span class="ansigreen">from</span> __future__ <span class="ansigreen">import</span> print_function<span class="ansiyellow">,</span> division<span class="ansiyellow">,</span> absolute_import<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 2</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> numba <span class="ansigreen">import</span> utils<span class="ansiyellow">,</span> typing<span class="ansiyellow"></span>
<span class="ansigreen">      3</span> <span class="ansigreen">from</span> numba<span class="ansiyellow">.</span>targets <span class="ansigreen">import</span> cpu<span class="ansiyellow"></span>
<span class="ansigreen">      4</span> <span class="ansigreen">from</span> numba<span class="ansiyellow">.</span>targets<span class="ansiyellow">.</span>descriptors <span class="ansigreen">import</span> TargetDescriptor<span class="ansiyellow"></span>
<span class="ansigreen">      5</span> <span class="ansigreen">from</span> numba <span class="ansigreen">import</span> dispatcher<span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/typing/__init__.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      1</span> <span class="ansigreen">from</span> __future__ <span class="ansigreen">import</span> absolute_import<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 2</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> <span class="ansiyellow">.</span>context <span class="ansigreen">import</span> BaseContext<span class="ansiyellow">,</span> Context<span class="ansiyellow">,</span> new_method<span class="ansiyellow"></span>
<span class="ansigreen">      3</span> <span class="ansigreen">from</span> <span class="ansiyellow">.</span>templates <span class="ansigreen">import</span> signature<span class="ansiyellow">,</span> make_concrete_template<span class="ansiyellow"></span>
<span class="ansigreen">      4</span> <span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/typing/context.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      4</span> <span class="ansigreen">import</span> numpy<span class="ansiyellow"></span>
<span class="ansigreen">      5</span> <span class="ansigreen">from</span> numba <span class="ansigreen">import</span> types<span class="ansiyellow">,</span> utils<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 6</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> numba<span class="ansiyellow">.</span>typeconv <span class="ansigreen">import</span> rules<span class="ansiyellow"></span>
<span class="ansigreen">      7</span> <span class="ansigreen">from</span> <span class="ansiyellow">.</span> <span class="ansigreen">import</span> templates<span class="ansiyellow"></span>
<span class="ansigreen">      8</span> <span class="ansired"># Initialize declarations</span><span class="ansiyellow"></span><span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/typeconv/rules.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      1</span> <span class="ansigreen">from</span> __future__ <span class="ansigreen">import</span> print_function<span class="ansiyellow">,</span> absolute_import<span class="ansiyellow"></span>
<span class="ansigreen">      2</span> <span class="ansigreen">import</span> itertools<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 3</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> <span class="ansiyellow">.</span>typeconv <span class="ansigreen">import</span> TypeManager<span class="ansiyellow"></span>
<span class="ansigreen">      4</span> <span class="ansigreen">from</span> numba <span class="ansigreen">import</span> types<span class="ansiyellow"></span>
<span class="ansigreen">      5</span> <span class="ansiyellow"></span>

<span class="ansigreen">/homeb/zam/meinke/.local/lib/python2.7/site-packages/numba/typeconv/typeconv.py</span> in <span class="ansicyan">&lt;module&gt;</span><span class="ansiblue">()</span>
<span class="ansigreen">      1</span> <span class="ansigreen">from</span> __future__ <span class="ansigreen">import</span> print_function<span class="ansiyellow">,</span> absolute_import<span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 2</span><span class="ansiyellow"> </span><span class="ansigreen">from</span> <span class="ansiyellow">.</span> <span class="ansigreen">import</span> _typeconv<span class="ansiyellow"></span>
<span class="ansigreen">      3</span> <span class="ansiyellow"></span>
<span class="ansigreen">      4</span> <span class="ansiyellow"></span>
<span class="ansigreen">      5</span> <span class="ansigreen">class</span> TypeManager<span class="ansiyellow">(</span>object<span class="ansiyellow">)</span><span class="ansiyellow">:</span><span class="ansiyellow"></span>

<span class="ansired">ImportError</span>: libirng.so: cannot open shared object file: No such file or directory</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[17]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="nd">@vectorize</span><span class="p">([</span><span class="s">&#39;f8(f8)&#39;</span><span class="p">,</span><span class="s">&#39;f4(f4)&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">mysinh</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pysinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[18]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="o">%</span><span class="k">timeit</span> <span class="n">mysinh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
10 loops, best of 3: 50.4 ms per loop

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use vectorize to make you favorite function into a ufunc.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>